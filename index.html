<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FridgeMind ‚Äî Dashboard</title>
<style>
  :root{
    --bg: #e7f6ff; 
    --card:#fff; 
    --shadow:0 4px 14px rgba(0,0,0,0.08);
    --pink:#ffb6c1;
    --pink-dark:#ff9eb3;
    --red:#f76c6c;
    --warn-bg:#ffd1dc;
  }
  body{
    margin:0; font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background: linear-gradient(135deg,#d4f0ff 0%,#f9e7f5 100%);
    color:#333; padding:0; overflow-x:hidden;
  }
  h1{ text-align:center; margin:12px 0; color:#ff6f9a; }
  .wrap{ max-width:960px; margin:0 auto; padding:24px; }
  .card{ background:var(--card); border-radius:16px; padding:18px; box-shadow:var(--shadow); }
  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  input[type="text"], input[type="date"]{
    padding:10px 12px; border-radius:12px; border:1px solid #f3dbe2; font-size:14px; flex:1;
  }
  button{
    background:var(--pink); color:white; border:none; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600;
    transition:0.2s;
  }
  button:hover{opacity:0.9;}
  button.secondary{ background:#fff; color:#333; border:1px solid #f3dbe2; }
  button.red{ background:var(--red); }
  button:disabled{ opacity:.6; transform:none; cursor:default; }
  .items{ margin-top:16px; display:flex; flex-direction:column; gap:10px; }
  .item-card{ background:#fff; border-radius:12px; padding:12px; box-shadow:0 2px 8px rgba(0,0,0,.05); display:flex; justify-content:space-between; align-items:flex-start; gap:12px; flex-wrap:wrap; }
  .info{ display:flex; flex-direction:column; gap:6px; min-width:220px; }
  .name{ font-weight:700; font-size:15px; }
  .expiry{ color:#666; font-size:14px; }
  .badge{ background:var(--warn-bg); color:#9b1b2b; padding:4px 10px; border-radius:999px; font-weight:700; font-size:12px; }
  .suggest{ font-size:13px; color:#666; font-style:italic; }
  .toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:20px; background:#222; color:#fff; padding:8px 14px; border-radius:999px; font-size:13px; z-index:999; }
  /* Sidebar */
  .sidebar{ position:fixed; top:0; left:-240px; width:240px; height:100%; background:#fff; box-shadow:2px 0 12px rgba(0,0,0,0.1); transition:0.3s; padding:24px; z-index:10; display:flex; flex-direction:column; gap:12px;}
  .sidebar.show{left:0;}
  .sidebar button{width:100%; text-align:left;}
  .overlay{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.2); display:none; z-index:9;}
  .overlay.show{display:block;}
  .topbar{display:flex; justify-content:space-between; align-items:center; padding:12px 24px; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.05);}
</style>
</head>
<body>

<div class="topbar">
  <button id="menuBtn">‚ò∞ Menu</button>
  <h1>ü•ï FridgeMind</h1>
  <button id="testNotifBtn">üîî Test Notification</button>
</div>

<div class="overlay" id="overlay"></div>
<div class="sidebar" id="sidebar">
  <button data-view="home">üè† Home / Dashboard</button>
  <button data-view="categories">ü•õ Categories</button>
  <button data-view="nearexpiry">‚ö†Ô∏è Near Expiry</button>
  <button data-view="recipes">üç≥ Recipe Suggestions</button>
  <button data-view="trash">üóëÔ∏è Trash / Deleted Items</button>
</div>

<div class="wrap" id="mainWrap">
  <!-- Add Item Card -->
  <div class="card" id="addCard">
    <div style="display:flex;gap:10px;flex-direction:column;">
      <div class="row">
        <input id="itemName" type="text" placeholder="Enter item name üçÖ" />
        <input id="expiryDate" type="date" />
        <button id="addBtn">‚ûï Add</button>
      </div>
    </div>
  </div>

  <div class="items" id="itemList"></div>
</div>

<script>
/* Pantry data with type and default expiry */
const pantry = {
  "tomato": { emoji:"üçÖ", recipes:["Tomato Chutney","Tomato Rasam"], expiry:5, type:"Vegetables" },
  "onion": { emoji:"üßÖ", recipes:["Onion Pakora"], expiry:5, type:"Vegetables" },
  "potato": { emoji:"ü•î", recipes:["Aloo Curry"], expiry:7, type:"Vegetables" },
  "carrot": { emoji:"ü•ï", recipes:["Carrot Halwa"], expiry:5, type:"Vegetables" },
  "bread": { emoji:"üçû", recipes:["Bread Upma"], expiry:3, type:"Bakery" },
  "milk": { emoji:"ü•õ", recipes:["Paneer"], expiry:3, type:"Dairy" },
  "rice": { emoji:"üçö", recipes:["Lemon Rice"], expiry:180, type:"Grains" },
  "egg": { emoji:"ü•ö", recipes:["Egg Bhurji"], expiry:10, type:"Eggs & Meat" },
  "apple": { emoji:"üçé", recipes:["Apple Pie"], expiry:7, type:"Fruits" }
};
const aliases = { "tomatoes":"tomato","potatoes":"potato" };

/* Sidebar toggle */
const menuBtn = document.getElementById('menuBtn');
const sidebar = document.getElementById('sidebar');
const overlay = document.getElementById('overlay');
menuBtn.addEventListener('click', ()=>{sidebar.classList.add('show'); overlay.classList.add('show');});
overlay.addEventListener('click', ()=>{sidebar.classList.remove('show'); overlay.classList.remove('show');});

/* UI refs */
const itemNameInput = document.getElementById('itemName');
const expiryInput = document.getElementById('expiryDate');
const addBtn = document.getElementById('addBtn');
const itemList = document.getElementById('itemList');
const testNotifBtn = document.getElementById('testNotifBtn');

function normalize(s){ return (s||"").toString().trim().toLowerCase(); }
function findPantryKeyFromLabel(label){
  if(!label) return null;
  const L = normalize(label);
  if(aliases[L]) return aliases[L];
  if(pantry[L]) return L;
  for(const key of Object.keys(pantry)){if(L.includes(key)) return key;}
  return null;
}

function showToast(msg){
  const t = document.createElement('div');
  t.className = 'toast'; t.textContent = msg;
  document.body.appendChild(t);
  setTimeout(()=> t.remove(), 2500);
}

/* Add item */
addBtn.addEventListener('click', addItem);
function addItem(){
  let raw = (itemNameInput.value || "").trim();
  if(!raw) {showToast("Enter item name"); return;}
  let keyTry = findPantryKeyFromLabel(raw.toLowerCase());
  let expiryDays = pantry[keyTry]?.expiry || 3;
  let expiry = expiryInput.value || new Date(Date.now()+expiryDays*24*60*60*1000).toISOString().split('T')[0];

  const dleft = daysUntil(expiry);
  const card = document.createElement('div'); card.className='item-card';
  const info = document.createElement('div'); info.className='info';

  if(dleft <=3){ const b=document.createElement('div'); b.className='badge'; b.textContent=`‚ö†Ô∏è Near Expiry (${dleft}d)`; info.appendChild(b);}
  const nameLine=document.createElement('div'); nameLine.className='name'; nameLine.textContent=raw; info.appendChild(nameLine);
  const expiryLine=document.createElement('div'); expiryLine.className='expiry'; expiryLine.textContent=`Expiry: ${expiry}`; info.appendChild(expiryLine);

  if(dleft<=3 && keyTry){
    const pool = pantry[keyTry].recipes; const pick = pool[Math.floor(Math.random()*pool.length)];
    const link=`https://www.youtube.com/results?search_query=${encodeURIComponent(pick+' recipe')}`;
    const s=document.createElement('div'); s.className='suggest'; s.innerHTML=`üç≥ Suggestion: <a href="${link}" target="_blank">${pick}</a>`;
    info.appendChild(s);
  }

  const delBtn=document.createElement('button'); delBtn.className='red'; delBtn.textContent='üóëÔ∏è Delete';
  delBtn.addEventListener('click', ()=>{card.remove(); showToast(`${raw} deleted`);});

  card.appendChild(info); card.appendChild(delBtn); itemList.prepend(card);

  itemNameInput.value=''; expiryInput.value='';
}

/* Days left */
function daysUntil(dateStr){ const t=new Date(); const e=new Date(dateStr); return Math.ceil((e-t)/(1000*60*60*24)); }

/* Test notification */
testNotifBtn.addEventListener('click', ()=>{
  if(Notification.permission==="granted"){
    new Notification("FridgeMind", { body:"This is a test notification! üîî", icon:"" });
    const audio = new Audio("https://www.soundjay.com/buttons/sounds/button-16.mp3"); audio.play();
  } else {
    Notification.requestPermission().then(p=>{if(p==="granted"){showToast("Permission granted! Click test again.");} else {showToast("Notification denied.");}});
  }
});

/* Sidebar menu actions */
sidebar.querySelectorAll('button[data-view]').forEach(b=>{
  b.addEventListener('click', ()=>{
    sidebar.classList.remove('show'); overlay.classList.remove('show');
    const view = b.getAttribute('data-view');
    switch(view){
      case 'home': showAllItems(); break;
      case 'categories': showCategories(); break;
      case 'nearexpiry': showNearExpiry(); break;
      case 'recipes': showRecipes(); break;
      case 'trash': showToast("Trash feature coming soon!"); break;
    }
  });
});

function showAllItems(){ Array.from(itemList.children).forEach(c=>c.style.display='flex'); }
function showNearExpiry(){ Array.from(itemList.children).forEach(c=>{
  const badge = c.querySelector('.badge');
  c.style.display = badge? 'flex':'none';
});}
function showRecipes(){ Array.from(itemList.children).forEach(c=>c.style.display='flex'); showToast("Click suggestions links!"); }
function showCategories(){
  const types=[...new Set(Object.values(pantry).map(p=>p.type))];
  const catChoice = prompt("Enter category:\n"+types.join(", "));
  if(!catChoice) return;
  Array.from(itemList.children).forEach(c=>{
    const key = findPantryKeyFromLabel(c.querySelector('.name').textContent);
    c.style.display = (pantry[key].type.toLowerCase() === catChoice.toLowerCase())? 'flex':'none';
  });
}
</script>
</body>
</html>

